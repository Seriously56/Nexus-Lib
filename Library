-- Keep all original Linoria functionality
local cloneref = (cloneref or clonereference or function(instance: any) return instance end)
local InputService: UserInputService = cloneref(game:GetService('UserInputService'));
local TextService: TextService = cloneref(game:GetService('TextService'));
local CoreGui: CoreGui = cloneref(game:GetService('CoreGui'));
local Teams: Teams = cloneref(game:GetService('Teams'));
local Players: Players = cloneref(game:GetService('Players'));
local RunService: RunService = cloneref(game:GetService('RunService'));
local TweenService: TweenService = cloneref(game:GetService('TweenService'));
local RenderStepped = RunService.RenderStepped;
local LocalPlayer = Players.LocalPlayer;
local Mouse = LocalPlayer:GetMouse();

local DrawingLib = typeof(Drawing) == "table" and Drawing or { drawing_replaced = true };
local ProtectGui = protectgui or (function() end);
local GetHUI = gethui or (function() return CoreGui end);

local IsBadDrawingLib = false;

local function SafeParentUI(Instance: Instance, Parent: Instance | () -> Instance)
    if not pcall(function()
        local DestinationParent
        if typeof(Parent) == "function" then
            DestinationParent = Parent()
        else
            DestinationParent = Parent
        end

        Instance.Parent = DestinationParent
    end) then
        Instance.Parent = LocalPlayer:WaitForChild("PlayerGui", math.huge)
    end
end

local function ParentUI(UI: Instance, SkipHiddenUI: boolean?)
    if SkipHiddenUI then
        SafeParentUI(UI, CoreGui)
        return
    end

    pcall(ProtectGui, UI)
    SafeParentUI(UI, GetHUI)
end

local ScreenGui = Instance.new('ScreenGui');
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Global;
ScreenGui.DisplayOrder = 999;
ScreenGui.ResetOnSpawn = false;
ParentUI(ScreenGui);

local ModalScreenGui = Instance.new("ScreenGui");
ModalScreenGui.DisplayOrder = 999;
ModalScreenGui.ResetOnSpawn = false;
ParentUI(ModalScreenGui, true);

local ModalElement = Instance.new("TextButton");
ModalElement.BackgroundTransparency = 1
ModalElement.Modal = false
ModalElement.Size = UDim2.fromScale(0, 0)
ModalElement.Text = ""
ModalElement.ZIndex = -999
ModalElement.Parent = ModalScreenGui

local Toggles = {};
local Options = {};
local Labels = {};
local Buttons = {};

getgenv().Linoria = {
    Toggles = Toggles;
    Options = Options;
    Labels = Labels;
    Buttons = Buttons;
}

getgenv().Toggles = Toggles;
getgenv().Options = Options;
getgenv().Labels = Labels;
getgenv().Buttons = Buttons;

local LibraryMainOuterFrame = nil;
local Library = {
    Registry = {};
    RegistryMap = {};

    HudRegistry = {};

    FontColor = Color3.fromRGB(255, 240, 245);
    MainColor = Color3.fromRGB(25, 15, 25);
    BackgroundColor = Color3.fromRGB(15, 8, 15);

    AccentColor = Color3.fromRGB(255, 105, 180);
    DisabledAccentColor = Color3.fromRGB(142, 142, 142);

    OutlineColor = Color3.fromRGB(60, 40, 55);
    DisabledOutlineColor = Color3.fromRGB(70, 70, 70);

    DisabledTextColor = Color3.fromRGB(142, 142, 142);

    RiskColor = Color3.fromRGB(255, 50, 50);

    Black = Color3.new(0, 0, 0);
    Font = Enum.Font.Gotham,

    OpenedFrames = {};
    DependencyBoxes = {};

    UnloadSignals = {};
    Signals = {};
    ScreenGui = ScreenGui;
    
    ActiveTab = nil;
    Toggled = false;

    IsMobile = false;
    DevicePlatform = Enum.Platform.None;

    CanDrag = true;
    CantDragForced = false;

    NotifySide = "Left";
    ShowCustomCursor = true;
    ShowToggleFrameInKeybinds = true;
    NotifyOnError = false;

    VideoLink = "";
    TotalTabs = 0;

    Toggles = Toggles;
    Options = Options;
    Labels = Labels;
    Buttons = Buttons;
};

-- ========================================
-- PARTICLE SYSTEM (NEXUS STYLE)
-- ========================================
local ParticleState = {
    Particles = {},
    IsDestroyed = false,
    MousePosition = {X = 0, Y = 0},
    GuiBounds = {MinX = 0, MaxX = 0, MinY = 0, MaxY = 0}
}

local NexusColors = {
    PinkLight = Color3.fromRGB(255, 182, 193),
    PinkMedium = Color3.fromRGB(255, 105, 180),
    PinkDark = Color3.fromRGB(255, 20, 147),
    PinkBright = Color3.fromRGB(255, 130, 190),
    PinkNeon = Color3.fromRGB(255, 60, 160)
}

local function UpdateGuiBounds(container)
    if not container then return end
    local absolutePosition = container.AbsolutePosition
    local absoluteSize = container.AbsoluteSize
    
    ParticleState.GuiBounds = {
        MinX = absolutePosition.X,
        MaxX = absolutePosition.X + absoluteSize.X,
        MinY = absolutePosition.Y,
        MaxY = absolutePosition.Y + absoluteSize.Y
    }
end

local function CreateNexusParticle(container)
    if not container or not container.Parent or ParticleState.IsDestroyed then
        return nil
    end
    
    local size = math.random(8, 24)
    local particle = Instance.new('Frame')
    particle.Size = UDim2.new(0, size, 0, size)
    
    local startX = math.random(0, 100) / 100
    local startY = math.random(0, 100) / 100
    particle.Position = UDim2.new(startX, 0, startY, 0)
    
    particle.BackgroundColor3 = NexusColors.PinkLight
    particle.BackgroundTransparency = math.random(60, 85) / 100
    particle.BorderSizePixel = 0
    particle.ZIndex = 5
    particle.Selectable = false
    particle.Parent = container
    
    local corner = Instance.new('UICorner')
    corner.CornerRadius = UDim.new(1, 0)
    corner.Parent = particle
    
    local gradient = Instance.new('UIGradient')
    local bubbleColors = {
        NexusColors.PinkLight,
        NexusColors.PinkMedium,
        NexusColors.PinkDark,
        Color3.fromRGB(255, 150, 200)
    }
    local color1 = bubbleColors[math.random(#bubbleColors)]
    local color2 = bubbleColors[math.random(#bubbleColors)]
    
    gradient.Color = ColorSequence.new({
        ColorSequenceKeypoint.new(0, color1),
        ColorSequenceKeypoint.new(0.3, Color3.fromRGB(255, 220, 230)),
        ColorSequenceKeypoint.new(0.7, color2),
        ColorSequenceKeypoint.new(1, color1)
    })
    gradient.Rotation = math.random(0, 360)
    gradient.Parent = particle
    
    local highlight = Instance.new('Frame')
    highlight.Size = UDim2.new(0.3, 0, 0.3, 0)
    highlight.Position = UDim2.new(0.2, 0, 0.15, 0)
    highlight.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    highlight.BackgroundTransparency = 0.3
    highlight.BorderSizePixel = 0
    highlight.ZIndex = particle.ZIndex + 1
    highlight.Parent = particle
    
    local highlightCorner = Instance.new('UICorner')
    highlightCorner.CornerRadius = UDim.new(1, 0)
    highlightCorner.Parent = highlight
    
    local glow = Instance.new('Frame')
    glow.Size = UDim2.new(1.8, 0, 1.8, 0)
    glow.Position = UDim2.new(-0.4, 0, -0.4, 0)
    glow.BackgroundColor3 = NexusColors.PinkLight
    glow.BackgroundTransparency = 0.9
    glow.BorderSizePixel = 0
    glow.ZIndex = particle.ZIndex - 1
    glow.Parent = particle
    
    local glowCorner = Instance.new('UICorner')
    glowCorner.CornerRadius = UDim.new(1, 0)
    glowCorner.Parent = glow
    
    local particleData = {
        frame = particle,
        vx = (math.random() - 0.5) * 0.002,
        vy = (math.random() - 0.5) * 0.002,
        created = tick(),
        rotation = 0,
        rotationSpeed = (math.random() - 0.5) * 2,
        pulsePhase = math.random() * math.pi * 2,
        driftPhase = math.random() * math.pi * 2,
        originalTransparency = particle.BackgroundTransparency,
        glow = glow,
        highlight = highlight,
        lifetime = math.random(30, 60),
        originalSize = size,
        wobblePhase = math.random() * math.pi * 2,
        repelForce = {x = 0, y = 0},
        mass = size / 10
    }
    
    table.insert(ParticleState.Particles, particleData)
    return particle
end

local function UpdateNexusParticles(container)
    if ParticleState.IsDestroyed or not container then return end
    
    UpdateGuiBounds(container)
    
    local screenSize = container.AbsoluteSize
    local mouseScreenX = (ParticleState.MousePosition.X - ParticleState.GuiBounds.MinX) / screenSize.X
    local mouseScreenY = (ParticleState.MousePosition.Y - ParticleState.GuiBounds.MinY) / screenSize.Y
    
    for i = #ParticleState.Particles, 1, -1 do
        local p = ParticleState.Particles[i]
        
        if not p or not p.frame or not p.frame.Parent then
            table.remove(ParticleState.Particles, i)
        else
            local currentPos = p.frame.Position
            local age = tick() - p.created
            
            if age > p.lifetime then
                p.frame:Destroy()
                table.remove(ParticleState.Particles, i)
            else
                local distanceToMouse = math.sqrt(
                    (currentPos.X.Scale - mouseScreenX)^2 + 
                    (currentPos.Y.Scale - mouseScreenY)^2
                )
                
                local repelStrength = 0.08
                local repelRadius = 0.15
                local repelForceX = 0
                local repelForceY = 0
                
                if distanceToMouse < repelRadius and distanceToMouse > 0 then
                    local repelPower = (repelRadius - distanceToMouse) / repelRadius
                    repelPower = repelPower * repelStrength / p.mass
                    
                    local directionX = (currentPos.X.Scale - mouseScreenX) / distanceToMouse
                    local directionY = (currentPos.Y.Scale - mouseScreenY) / distanceToMouse
                    
                    repelForceX = directionX * repelPower
                    repelForceY = directionY * repelPower
                end
                
                p.repelForce.x = p.repelForce.x * 0.85 + repelForceX * 0.15
                p.repelForce.y = p.repelForce.y * 0.85 + repelForceY * 0.15
                
                local newX = currentPos.X.Scale + p.vx + p.repelForce.x
                local newY = currentPos.Y.Scale + p.vy + p.repelForce.y
                
                if newX < 0 then 
                    newX = 0 
                    p.vx = math.abs(p.vx) * 0.5
                elseif newX > 1 then 
                    newX = 1 
                    p.vx = -math.abs(p.vx) * 0.5
                end
                
                if newY < 0 then 
                    newY = 0 
                    p.vy = math.abs(p.vy) * 0.5
                elseif newY > 1 then 
                    newY = 1 
                    p.vy = -math.abs(p.vy) * 0.5
                end
                
                local wobbleTime = tick() * 1.5 + p.wobblePhase
                newX = newX + math.sin(wobbleTime) * 0.001
                newY = newY + math.cos(wobbleTime * 0.7) * 0.001
                
                newX = newX + (math.random() - 0.5) * 0.0004
                newY = newY + (math.random() - 0.5) * 0.0003
                
                p.rotation = p.rotation + p.rotationSpeed
                p.frame.Rotation = p.rotation
                
                local breathe = math.sin(tick() * 2.5 + p.pulsePhase) * 0.1 + 1
                local currentSize = p.originalSize * breathe
                p.frame.Size = UDim2.new(0, currentSize, 0, currentSize)
                
                local transparencyPulse = math.sin(tick() * 3 + p.pulsePhase) * 0.1
                local newTransparency = math.max(0.5, math.min(0.95, p.originalTransparency + transparencyPulse))
                p.frame.BackgroundTransparency = newTransparency
                
                local glowIntensity = 0.9
                if distanceToMouse < 0.2 then
                    glowIntensity = 0.7 + (distanceToMouse / 0.2) * 0.2
                end
                p.glow.BackgroundTransparency = glowIntensity
                
                local shimmer = math.sin(tick() * 4 + p.pulsePhase) * 0.2 + 0.3
                p.highlight.BackgroundTransparency = shimmer
                
                p.vx = p.vx * 0.995
                p.vy = p.vy * 0.998
                
                p.frame.Position = UDim2.new(newX, 0, newY, 0)
            end
        end
    end
end

local function StartNexusParticleSystem(container)
    UpdateGuiBounds(container)
    
    UserInputService.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement then
            local mousePos = input.Position
            if mousePos.X >= ParticleState.GuiBounds.MinX and mousePos.X <= ParticleState.GuiBounds.MaxX and
               mousePos.Y >= ParticleState.GuiBounds.MinY and mousePos.Y <= ParticleState.GuiBounds.MaxY then
                ParticleState.MousePosition.X = mousePos.X
                ParticleState.MousePosition.Y = mousePos.Y
            end
        end
    end)
    
    task.spawn(function()
        for i = 1, 20 do
            if ParticleState.IsDestroyed then break end
            CreateNexusParticle(container)
            task.wait(math.random(20, 100) / 1000)
        end
        
        while not ParticleState.IsDestroyed and container.Parent do
            if #ParticleState.Particles < 40 then
                CreateNexusParticle(container)
            end
            task.wait(math.random(400, 1200) / 1000)
        end
    end)
    
    task.spawn(function()
        while not ParticleState.IsDestroyed and container.Parent do
            pcall(function() UpdateNexusParticles(container) end)
            task.wait(1/60)
        end
    end)
end

-- ========================================
-- NEXUS STYLE WINDOW CREATION
-- ========================================
local NexusWindow = nil

function Library:CreateNexusWindow(config)
    local Config = config or {}
    Config.Title = Config.Title or "NEXUS"
    Config.Size = Config.Size or UDim2.new(0, 550, 0, 600)
    Config.Position = Config.Position or UDim2.new(0.5, -275, 0.5, -300)
    
    -- Create Nexus Main Container
    local MainContainer = Library:Create('Frame', {
        Name = "NexusMainContainer",
        AnchorPoint = Vector2.new(0.5, 0.5),
        Size = Config.Size,
        Position = Config.Position,
        BackgroundColor3 = Library.BackgroundColor,
        BackgroundTransparency = 0,
        BorderSizePixel = 0,
        ZIndex = 1000,
        Parent = ScreenGui
    })

    local MainCorner = Library:Create('UICorner', {
        CornerRadius = UDim.new(0, 20),
        Parent = MainContainer
    })

    local MainStroke = Library:Create('UIStroke', {
        Color = NexusColors.PinkMedium,
        Thickness = 2,
        Transparency = 0.2,
        Parent = MainContainer
    })

    Library:AddToRegistry(MainContainer, {
        BackgroundColor3 = 'BackgroundColor'
    })

    -- Particle Container for Nexus Effects
    local ParticleContainer = Library:Create('Frame', {
        Size = UDim2.new(1, 0, 1, 0),
        BackgroundTransparency = 1,
        ZIndex = 5,
        Parent = MainContainer
    })

    -- Animated Border (Nexus Style)
    local AnimatedBorder = Library:Create('Frame', {
        Name = "AnimatedBorder",
        Size = UDim2.new(1, 8, 1, 8),
        Position = UDim2.new(0, -4, 0, -4),
        BackgroundTransparency = 1,
        ZIndex = 999,
        Parent = MainContainer
    })

    local BorderCorner = Library:Create('UICorner', {
        CornerRadius = UDim.new(0, 24),
        Parent = AnimatedBorder
    })

    local BorderStroke = Library:Create('UIStroke', {
        Color = NexusColors.PinkLight,
        Thickness = 3,
        Transparency = 0.3,
        Parent = AnimatedBorder
    })

    local BorderGradient = Library:Create('UIGradient', {
        Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, NexusColors.PinkLight),
            ColorSequenceKeypoint.new(0.3, NexusColors.PinkMedium),
            ColorSequenceKeypoint.new(0.7, NexusColors.PinkDark),
            ColorSequenceKeypoint.new(1, NexusColors.PinkLight)
        },
        Transparency = NumberSequence.new{
            NumberSequenceKeypoint.new(0, 0.8),
            NumberSequenceKeypoint.new(0.2, 0.1),
            NumberSequenceKeypoint.new(0.8, 0.1),
            NumberSequenceKeypoint.new(1, 0.8)
        },
        Parent = BorderStroke
    })

    -- NEXUS Header
    local Header = Library:Create('Frame', {
        Name = "Header",
        Size = UDim2.new(1, 0, 0, 120),
        BackgroundTransparency = 1,
        ZIndex = 1001,
        Parent = MainContainer
    })

    local TitleContainer = Library:Create('Frame', {
        Size = UDim2.new(1, -40, 0, 100),
        Position = UDim2.new(0, 20, 0, 10),
        BackgroundTransparency = 1,
        ZIndex = 1001,
        Parent = Header
    })

    -- NEXUS Text
    local NexusText = Library:Create('TextLabel', {
        Size = UDim2.new(1, 0, 0.5, 0),
        BackgroundTransparency = 1,
        Text = "NEXUS",
        TextColor3 = Library.FontColor,
        TextScaled = true,
        Font = Enum.Font.GothamBlack,
        TextStrokeTransparency = 0.7,
        TextStrokeColor3 = NexusColors.PinkDark,
        ZIndex = 1002,
        Parent = TitleContainer
    })

    local NexusGradient = Library:Create('UIGradient', {
        Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, NexusColors.PinkLight),
            ColorSequenceKeypoint.new(0.5, NexusColors.PinkMedium),
            ColorSequenceKeypoint.new(1, NexusColors.PinkDark)
        },
        Rotation = 45,
        Parent = NexusText
    })

    -- Main Content Area
    local Content = Library:Create('Frame', {
        Name = "Content",
        Size = UDim2.new(1, -40, 1, -140),
        Position = UDim2.new(0, 20, 0, 140),
        BackgroundTransparency = 1,
        ZIndex = 1001,
        Parent = MainContainer
    })

    -- Tab System (Nexus Style)
    local TabArea = Library:Create('ScrollingFrame', {
        ScrollingDirection = Enum.ScrollingDirection.X,
        CanvasSize = UDim2.new(0, 0, 2, 0),
        HorizontalScrollBarInset = Enum.ScrollBarInset.Always,
        AutomaticCanvasSize = Enum.AutomaticSize.XY,
        ScrollBarThickness = 0,
        BackgroundTransparency = 1,
        Position = UDim2.new(0, 0, 0, 0),
        Size = UDim2.new(1, 0, 0, 40),
        ZIndex = 1001,
        Parent = Content
    })

    local TabListLayout = Library:Create('UIListLayout', {
        Padding = UDim.new(0, 8),
        FillDirection = Enum.FillDirection.Horizontal,
        SortOrder = Enum.SortOrder.LayoutOrder,
        VerticalAlignment = Enum.VerticalAlignment.Center,
        Parent = TabArea
    })

    local TabContent = Library:Create('Frame', {
        Size = UDim2.new(1, 0, 1, -50),
        Position = UDim2.new(0, 0, 0, 50),
        BackgroundTransparency = 1,
        ZIndex = 1001,
        Parent = Content
    })

    -- Window functionality
    local Window = {
        Tabs = {},
        Container = MainContainer,
        Content = Content,
        TabArea = TabArea,
        TabContent = TabContent,
        CurrentTab = nil
    }

    -- Make draggable
    Library:MakeDraggable(Header, 25, true)

    -- Start animations
    local borderTween = TweenService:Create(BorderGradient, 
        TweenInfo.new(4, Enum.EasingStyle.Linear, Enum.EasingDirection.InOut, -1), 
        {Rotation = 360})
    borderTween:Play()

    -- Start particle system
    StartNexusParticleSystem(ParticleContainer)

    -- Entrance animation
    MainContainer.Size = UDim2.new(0, 0, 0, 0)
    MainContainer.BackgroundTransparency = 1
    
    TweenService:Create(MainContainer, 
        TweenInfo.new(0.5, Enum.EasingStyle.Back, Enum.EasingDirection.Out), 
        {Size = Config.Size, BackgroundTransparency = 0}):Play()

    function Window:AddTab(name)
        local Tab = {
            Name = name,
            Elements = {}
        }

        -- Tab Button (Nexus Style)
        local TabButton = Library:Create('TextButton', {
            Size = UDim2.new(0, 120, 0, 35),
            BackgroundColor3 = Library.MainColor,
            BorderSizePixel = 0,
            Text = name,
            TextColor3 = Library.FontColor,
            TextSize = 14,
            Font = Enum.Font.GothamBold,
            AutoButtonColor = false,
            ZIndex = 1002,
            Parent = TabArea
        })

        local TabCorner = Library:Create('UICorner', {
            CornerRadius = UDim.new(0, 8),
            Parent = TabButton
        })

        local TabGradient = Library:Create('UIGradient', {
            Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, NexusColors.PinkDark),
                ColorSequenceKeypoint.new(1, NexusColors.PinkMedium)
            },
            Rotation = 90,
            Parent = TabButton
        })

        Library:AddToRegistry(TabButton, {
            BackgroundColor3 = 'MainColor'
        })

        -- Tab Content
        local TabFrame = Library:Create('Frame', {
            Size = UDim2.new(1, 0, 1, 0),
            BackgroundTransparency = 1,
            Visible = false,
            ZIndex = 1001,
            Parent = TabContent
        })

        local LeftSide = Library:Create('ScrollingFrame', {
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            Position = UDim2.new(0, 0, 0, 0),
            Size = UDim2.new(0.5, -5, 1, 0),
            CanvasSize = UDim2.new(0, 0, 0, 0),
            ScrollBarThickness = 0,
            ZIndex = 1001,
            Parent = TabFrame
        })

        local RightSide = Library:Create('ScrollingFrame', {
            BackgroundTransparency = 1,
            BorderSizePixel = 0,
            Position = UDim2.new(0.5, 5, 0, 0),
            Size = UDim2.new(0.5, -5, 1, 0),
            CanvasSize = UDim2.new(0, 0, 0, 0),
            ScrollBarThickness = 0,
            ZIndex = 1001,
            Parent = TabFrame
        })

        Library:Create('UIListLayout', {
            Padding = UDim.new(0, 8),
            FillDirection = Enum.FillDirection.Vertical,
            SortOrder = Enum.SortOrder.LayoutOrder,
            HorizontalAlignment = Enum.HorizontalAlignment.Center,
            Parent = LeftSide
        })

        Library:Create('UIListLayout', {
            Padding = UDim.new(0, 8),
            FillDirection = Enum.FillDirection.Vertical,
            SortOrder = Enum.SortOrder.LayoutOrder,
            HorizontalAlignment = Enum.HorizontalAlignment.Center,
            Parent = RightSide
        })

        for _, Side in next, { LeftSide, RightSide } do
            Side:WaitForChild('UIListLayout'):GetPropertyChangedSignal('AbsoluteContentSize'):Connect(function()
                Side.CanvasSize = UDim2.fromOffset(0, Side.UIListLayout.AbsoluteContentSize.Y)
            end)
        end

        function Tab:Show()
            if Window.CurrentTab then
                Window.CurrentTab:Hide()
            end
            
            Window.CurrentTab = Tab
            TabFrame.Visible = true
            
            -- Update tab button appearance
            TabGradient.Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, NexusColors.PinkMedium),
                ColorSequenceKeypoint.new(1, NexusColors.PinkBright)
            }
        end

        function Tab:Hide()
            TabFrame.Visible = false
            TabGradient.Color = ColorSequence.new{
                ColorSequenceKeypoint.new(0, NexusColors.PinkDark),
                ColorSequenceKeypoint.new(1, NexusColors.PinkMedium)
            }
        end

        function Tab:AddSection(side, name)
            local Section = {}
            local SideFrame = side == "Left" and LeftSide or RightSide

            -- Section Container (Nexus Style)
            local SectionOuter = Library:Create('Frame', {
                BackgroundColor3 = Library.MainColor,
                BorderColor3 = NexusColors.PinkMedium,
                BorderMode = Enum.BorderMode.Inset,
                Size = UDim2.new(1, 0, 0, 0),
                ZIndex = 1002,
                Parent = SideFrame
            })

            Library:AddToRegistry(SectionOuter, {
                BackgroundColor3 = 'MainColor',
                BorderColor3 = function() return NexusColors.PinkMedium end
            })

            local SectionInner = Library:Create('Frame', {
                BackgroundColor3 = Library.MainColor,
                BorderColor3 = Color3.new(0, 0, 0),
                Size = UDim2.new(1, -2, 1, -2),
                Position = UDim2.new(0, 1, 0, 1),
                ZIndex = 1003,
                Parent = SectionOuter
            })

            Library:AddToRegistry(SectionInner, {
                BackgroundColor3 = 'MainColor'
            })

            local Highlight = Library:Create('Frame', {
                BackgroundColor3 = NexusColors.PinkMedium,
                BorderSizePixel = 0,
                Size = UDim2.new(1, 0, 0, 2),
                ZIndex = 1004,
                Parent = SectionInner
            })

            Library:AddToRegistry(Highlight, {
                BackgroundColor3 = function() return NexusColors.PinkMedium end
            })

            local SectionLabel = Library:Create('TextLabel', {
                Size = UDim2.new(1, 0, 0, 25),
                Position = UDim2.new(0, 8, 0, 2),
                BackgroundTransparency = 1,
                Text = name,
                TextColor3 = Library.FontColor,
                TextSize = 14,
                Font = Enum.Font.GothamBold,
                TextXAlignment = Enum.TextXAlignment.Left,
                ZIndex = 1004,
                Parent = SectionInner
            })

            local Container = Library:Create('Frame', {
                BackgroundTransparency = 1,
                Position = UDim2.new(0, 8, 0, 30),
                Size = UDim2.new(1, -16, 1, -38),
                ZIndex = 1003,
                Parent = SectionInner
            })

            Library:Create('UIListLayout', {
                FillDirection = Enum.FillDirection.Vertical,
                SortOrder = Enum.SortOrder.LayoutOrder,
                Parent = Container
            })

            function Section:Resize()
                local size = 0
                for _, child in ipairs(Container:GetChildren()) do
                    if not child:IsA('UIListLayout') and child.Visible then
                        size = size + child.Size.Y.Offset
                    end
                end
                SectionOuter.Size = UDim2.new(1, 0, 0, size + 38)
            end

            Section.Container = Container
            setmetatable(Section, BaseGroupbox)

            Section:AddBlank(5)
            Section:Resize()

            Tab.Elements[name] = Section
            return Section
        end

        TabButton.MouseButton1Click:Connect(function()
            Tab:Show()
        end)

        -- Show first tab by default
        if #Window.Tabs == 0 then
            Tab:Show()
        end

        table.insert(Window.Tabs, Tab)
        return Tab
    end

    function Window:Hide()
        MainContainer.Visible = false
    end

    function Window:Show()
        MainContainer.Visible = true
    end

    NexusWindow = Window
    return Window
end

-- Override the original CreateWindow to use Nexus style
local originalCreateWindow = Library.CreateWindow
function Library:CreateWindow(...)
    return self:CreateNexusWindow(...)
end

-- ========================================
-- NEXUS STYLE ELEMENTS
-- ========================================
function Library:CreateNexusButton(parent, text, callback)
    local Button = Library:Create('TextButton', {
        Size = UDim2.new(1, 0, 0, 40),
        BackgroundColor3 = Library.MainColor,
        BorderSizePixel = 0,
        Text = text,
        TextColor3 = Library.FontColor,
        TextSize = 14,
        Font = Enum.Font.GothamBold,
        AutoButtonColor = false,
        ZIndex = 1002,
        Parent = parent
    })

    local Corner = Library:Create('UICorner', {
        CornerRadius = UDim.new(0, 8),
        Parent = Button
    })

    local Gradient = Library:Create('UIGradient', {
        Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, NexusColors.PinkDark),
            ColorSequenceKeypoint.new(1, NexusColors.PinkMedium)
        },
        Rotation = 90,
        Parent = Button
    })

    Library:AddToRegistry(Button, {
        BackgroundColor3 = 'MainColor'
    })

    -- Hover effects
    Button.MouseEnter:Connect(function()
        TweenService:Create(Button, TweenInfo.new(0.2), {
            BackgroundColor3 = Color3.fromRGB(40, 25, 35)
        }):Play()
    end)

    Button.MouseLeave:Connect(function()
        TweenService:Create(Button, TweenInfo.new(0.2), {
            BackgroundColor3 = Library.MainColor
        }):Play()
    end)

    Button.MouseButton1Click:Connect(callback)

    return Button
end

function Library:CreateNexusToggle(parent, text, default, callback)
    local Toggle = {
        Value = default or false,
        Type = 'Toggle'
    }

    local Container = Library:Create('Frame', {
        Size = UDim2.new(1, 0, 0, 30),
        BackgroundTransparency = 1,
        ZIndex = 1002,
        Parent = parent
    })

    local ToggleButton = Library:Create('TextButton', {
        Size = UDim2.new(0, 50, 0, 25),
        Position = UDim2.new(1, -55, 0, 2),
        BackgroundColor3 = Library.MainColor,
        BorderSizePixel = 0,
        Text = "",
        AutoButtonColor = false,
        ZIndex = 1003,
        Parent = Container
    })

    local ToggleCorner = Library:Create('UICorner', {
        CornerRadius = UDim.new(0, 12),
        Parent = ToggleButton
    })

    local ToggleGradient = Library:Create('UIGradient', {
        Color = ColorSequence.new{
            ColorSequenceKeypoint.new(0, NexusColors.PinkDark),
            ColorSequenceKeypoint.new(1, NexusColors.PinkMedium)
        },
        Rotation = 90,
        Parent = ToggleButton
    })

    local ToggleLabel = Library:Create('TextLabel', {
        Size = UDim2.new(1, -60, 1, 0),
        BackgroundTransparency = 1,
        Text = text,
        TextColor3 = Library.FontColor,
        TextSize = 14,
        Font = Enum.Font.Gotham,
        TextXAlignment = Enum.TextXAlignment.Left,
        ZIndex = 1002,
        Parent = Container
    })

    function Toggle:SetValue(value)
        Toggle.Value = value
        if value then
            TweenService:Create(ToggleButton, TweenInfo.new(0.2), {
                BackgroundColor3 = NexusColors.PinkMedium
            }):Play()
        else
            TweenService:Create(ToggleButton, TweenInfo.new(0.2), {
                BackgroundColor3 = Library.MainColor
            }):Play()
        end
        if callback then callback(value) end
    end

    ToggleButton.MouseButton1Click:Connect(function()
        Toggle:SetValue(not Toggle.Value)
    end)

    Toggle:SetValue(default)

    return Toggle
end

-- ========================================
-- ORIGINAL LIBRARY FUNCTIONS (KEPT FOR COMPATIBILITY)
-- ========================================
pcall(function() Library.DevicePlatform = InputService:GetPlatform(); end);
Library.IsMobile = (Library.DevicePlatform == Enum.Platform.Android or Library.DevicePlatform == Enum.Platform.IOS);
Library.MinSize = if Library.IsMobile then Vector2.new(550, 200) else Vector2.new(550, 300);

local RainbowStep = 0
local Hue = 0
local DPIScale = 1

table.insert(Library.Signals, RenderStepped:Connect(function(Delta)
    RainbowStep = RainbowStep + Delta

    if RainbowStep >= (1 / 60) then
        RainbowStep = 0;
        Hue = Hue + (1 / 400);
        if Hue > 1 then Hue = 0; end;
        Library.CurrentRainbowHue = Hue;
        Library.CurrentRainbowColor = Color3.fromHSV(Hue, 0.8, 1);
    end;
end));

-- ... (Keep all other original Linoria functions exactly as they were)

-- Return the modified library with Nexus styling
return Library
